function [Y,Xf,Af] = OPNet_5fx(X,~,~)
%OPNET_5FX neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 11-May-2020 00:04:48.
% 
% [Y] = OPNet_5fx(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.0144208842331242;0.0109608161807619;0.00790402440892333;0.0062586252899126;0.00520250213628661];
x1_step1.gain = [2.21833677388427;2.68864482378868;3.35745142869665;4.13314247605687;5.01584951387499];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.95989504813156079077;2.6603553352603985793;-0.19465774718606052018;1.1129533124302759539;-3.1741175019527547718;0.29693981190924156888;2.6406108271833255152;0.84084995339117418744;1.5865679566790680255;-0.13235350640629062191];
IW1_1 = [2.070140642487374727 -0.67820088009997747669 -0.66128673282140448819 -0.12482839158588354689 -0.097390439658002841972;-0.83182196759592363922 -0.17175048086568714401 0.12776942876323355014 -0.00078233739936756259425 -0.56187340255546458501;-0.28178234418834846586 0.5471731538626272151 0.18086092666102360216 0.035431387784476200964 0.095961948317536446829;0.66142841144296382616 0.36094808310060344514 -0.18508443207533492592 -0.080661209404769673714 0.32101667295669639168;2.6899217915265776213 1.4413177933038745504 0.99142993983836202876 0.85750937591950016081 0.65757432654915970449;0.77573060223026857329 0.57116463906897274594 -1.033706874033470724 -0.037059027939482229452 0.12817824000579333688;-0.69267104653564748329 0.54554429789403546813 1.1590130511076885966 0.88225538327871921851 0.61282098968714748821;0.31800971660689281162 0.92962246584157814944 0.15867712502080208448 -0.073613204499814122173 -0.57069659448451082184;-0.62896895502671545941 -0.34751881226303810157 -0.40811699707414234028 -0.10587745890377306401 -0.19527398566043532857;0.79898712610633904063 -0.1672091451235889481 0.13588751923770420182 0.23388060104620048141 0.06685507319607611465];

% Layer 2
b2 = [-1.3171078952041661569;-0.12291694024905724936;-1.6196261453545701681;0.54344078251758742848;-1.0399823796396885367;0.76960925657990475468;0.10109118294472516086;0.11704102230733330614;0.095028316822094671679;-0.21112352989549373894];
LW2_1 = [-0.25763984313664822778 1.3213183284274767626 -0.32174493433588469138 1.0799420074504109124 -0.008996435697472335638 -0.950625637524732503 -0.13374299012434376355 -0.56217433839474306723 0.051800241040135107384 0.23755519047316178693;0.75614900700494591668 0.03181343736961766977 -0.66462918285191918688 0.53181515959806591187 0.011272523063707807697 -0.5187792717819095234 -0.36148642095239941208 0.048234379947821891255 0.19314295006951351374 1.1854991540477335388;0.032380362835810916344 -1.5040425681824263204 -0.088466181089104659052 0.65942837286615996195 2.2021178605987081767 0.2814857372084652587 2.2053092750882687945 1.6208764753462232555 1.9142298421291603638 0.083731653885517690061;-3.5199570953403225282 0.0029953731327935252671 0.45597493493216539884 -0.29975403080061641115 -0.012794068320450588394 -1.4207464309345427811 -0.38344490726839758343 -0.31727537055141347144 -0.21535016904061690668 -0.35800723322457822517;-0.7504815669455614513 1.160657884416961938 0.69982908138016985955 0.2466052567419234065 1.3710717490069694868 -0.17655014312867098325 1.4239469639965844916 1.2882318094508236062 0.41966702976091352362 1.1271114418780772137;-1.3963337623261455889 -0.63837629794071604206 0.96166563494994361516 0.75883752548695848628 0.00013139410136826817259 0.77105384889612738064 0.26710473265014722521 0.59490494758116507779 -0.35536261893031251269 -0.0046837256531428650072;-0.95964778138030448762 -2.9534282790956294384 0.45884216572280173141 -0.082103872110633316361 0.030970301650369388979 0.14671394436532997352 0.51809063460361692854 0.27576927088911606933 1.221384761147295217 -0.54718734701989246716;0.67660420779175256545 -0.11087664774669100942 -0.49779328814127693503 -0.14302888773142799494 -2.6024260087811361686 -0.2969963892129606764 -2.6370802597846227933 -1.5188499398347654612 -1.887236817542341516 -0.96774230330809973832;0.19051215809429714043 -1.6873862859074830745 0.23437068718573872417 0.48573449098279009029 0.03445614792937404941 0.036051862988181207492 -0.46944665723927714307 0.62185329469838124261 -0.30387484667562436602 -0.0098176774875105374957;-0.10530883545313390881 -0.95543314491954112189 0.042493265680302712284 -0.12295885308084428256 -1.7479177254722984003 -0.404968655460056004 -2.3730511387645401022 -2.2273457491517008044 -1.7798079868457585828 -0.37591029190896174672];

% Layer 3
b3 = [-1.0694852428302079606;2.2327451241677591653;0.84715796121085207293;-0.64571979038014248875;-0.18121880139773899332;0.93449459386539179828;-0.08414671118556325824;-0.28458805547067522745;-0.12455778158869611205;-0.24268060203216812454];
LW3_2 = [-0.6386508006803602866 0.4111244088293398713 0.17722166688882290408 -0.30368070780064815306 -0.24181376640862853322 -1.0648688383121442946 0.068608440239927376281 -0.11336117841339425627 -0.34135831908201558216 0.13088307774579455156;-0.39946125150280614724 -0.12444396628141421446 -0.73661120360761878079 -0.29496125352306046263 -0.062856169486008250935 0.15563499989599674511 -0.35275091957278209565 -0.79968485109969000835 -0.64468670932420968356 0.29465291408482402469;0.1006822966088349175 -1.1018312753465728804 0.071066625372840905306 1.9511738398323581478 0.0049010327541902688753 0.27973229171011571026 0.58091696812012449946 0.029898178500370412719 0.39396864251842056426 -1.6480907868644933956;-1.0464872863258372071 0.57604213032656270688 0.051297746601833824065 -0.24323639990447770698 0.92470628955386668935 -0.038761985266592691168 -0.7661707042567234005 1.6511291547667450441 0.78339490527410238219 -0.28585622373868974089;0.32133893597831653111 0.48876456976993254422 0.56509823744025855508 0.80025899444989578857 0.59773439651248450044 -1.1000818465857822304 1.3977549891612812694 1.2117941882232783346 0.03867805176022263286 0.0088896223893585243903;1.8613272504786742001 0.32254102287639735414 -0.068975131702564487779 0.61415250166829904455 0.21640732933355971701 -0.84647049514382211033 1.4612955385952244303 0.014038567202593861885 -0.77391173391349110666 0.70669900946125752128;-0.97709894524928564419 -0.85572383867272938662 -0.42238393147189517984 0.09422179081965244285 0.51797638032162285349 1.7815647586208480657 0.25843390545424904658 -1.9904313791560315217 0.3366408883041287492 -0.20682236540330836694;0.13551243230817380803 -0.68526209710559193855 0.0068718687088576736743 -0.86967781819516543074 -0.44079671279017806906 1.6191489741545088688 0.60407516386131776542 -3.1249782418448548427 -0.12478224683790341276 -0.17579109103294690564;0.28713137632061913607 -2.0749841066201915041 -0.056678356086307668527 0.45466384152309485822 -0.060536513112734356701 0.99620590952834131571 0.41637525393909236016 -0.10436904857757760279 0.26567949754327974121 -0.8804734159767156898;-0.63523937406715846876 0.028498573058892799625 0.17961077408584552595 -1.4304924498774393982 0.2513274417442577513 -0.27453767119441668809 -2.9608237971160420443 2.4215206989288908801 0.40006278271410394831 0.57184247635262852594];

% Layer 4
b4 = [-0.1605059637038213638;0.4296284131795953809;-0.14429531524584984781;0.07573342329053957267;-0.33445644121347239963;-0.8708251937105354612;0.3628343927101279065;0.1353017829556818763;0.30856812652432846766;0.15585773067344119158];
LW4_3 = [-0.56227058350618830396 -0.20688302390727217328 1.4925894405618616023 0.20513282684099490294 -0.34777203119759236838 0.36282296334907598867 0.85963701100659284382 0.012071419902115104739 0.89270864000730942855 -0.35279376424235081577;0.51475480029846309993 -0.458804126840660631 -1.7419397546139494537 0.057729010183885660912 0.5500551561066077122 1.1010102185693639854 -0.075237628719401539179 0.0038132494530854345142 -0.041111808426853725662 -0.19260989644589512904;0.68744976058495765869 0.68795793972097785129 -0.74897497376019461779 0.001588898844124604897 0.51083758184770333699 0.15664695925961683032 -0.037132192092400241601 0.017930167926761934882 -1.1842094752478182773 -0.23211000894208957956;-0.38241146588223073888 -0.39224847285212754988 -1.6303537042412925562 -0.077618106943178888368 0.12085489595700556198 -0.38348343471735690802 0.20051239652440216998 -0.0063284630718755258139 0.55812622317782689674 0.59576509193048043933;-0.56211761847308006068 0.22077221333889887611 1.6035891674473830015 -0.38283185282686182926 -0.43571908396157310595 -0.20505723637607006782 0.98436998517115248397 0.40023811314394158734 0.77370742908522860404 -0.53994785530675415419;-0.13409239688007870694 -0.32822332768861650631 1.2120937032685950019 -0.21843814856614907072 0.037353370549895639763 -0.38202472865772413302 0.71718603327851560003 -0.97402389402490341386 1.0831380011811690967 0.041456040931377897973;0.33116085911538661879 -0.044964309530583362884 -0.0083593728818878998421 0.16777599536992734985 0.71521503380434203745 0.39516071390856832846 -0.31746304293594446166 -0.27870950366473445925 0.071548370782501979903 0.94497369222220806151;0.13830549825112550821 0.1208510991413742075 -0.72558543927012886243 0.26233647407952798147 0.09550204609129052391 -0.010411982576524586933 -0.01574233726391690083 -0.10167596991217671409 -0.21583810628723795744 0.77254339126100257662;-0.34180332254958112337 -0.3972609435802290645 0.13269940120481502066 -0.19965370037122481817 0.69889314988927186967 2.1878990612704938279 0.14852341117633055534 -0.023926426689691169397 -0.98212097671018616651 0.33371245031907009748;0.26892550189119263093 0.11349570845207790359 -0.63941841039841618155 0.052792924532141044525 0.22652496420576986869 0.22838480045507980609 0.022483496084548273281 0.024162576240506009051 -0.50457709645763038075 0.83319608342487772035];

% Layer 5
b5 = [0.19268715161862734475;0.045734907364967790355;0.27654739863448457582;0.29267757493937324176;0.09835161805293597681;-0.080302062815341607172;-1.1589511679421677925;-0.069354548828332071575;0.77953616846136897234;0.048778387702086395405];
LW5_4 = [-0.18951830492319468591 0.86406669144991388176 -0.52508573722927776029 0.48323305732722421357 -0.22112069328723252259 0.64055854505815945643 -0.078956186423392304974 -0.035468805595945299136 0.4219955568925825018 -0.18589674404939843244;0.51982884280966301649 -0.1611728073502276537 0.021944703961453430191 0.22014208989367178848 0.64458116606634940915 -0.24419898282261262579 0.27580162484168535553 0.19344957714150429195 -0.58049551454414916041 -0.14529201481435080612;-0.032992349514538672761 0.29946324142153329939 -1.2197452151770891149 0.31333454668113180919 -0.5113210133202445995 0.030154982982513810208 0.48857117693132218195 -0.30279305395301819859 -1.7657487516568517449 -0.17620782899345258099;0.40958509794174474683 -0.37138260679530149533 -0.36363051476537622264 -0.33694985881494976532 0.10885029615816040061 -0.051479070406370855406 -0.073957874631442072078 0.085480657846163279889 -0.22546913197753762348 -0.064063835597998344817;-0.22691469893502508315 -0.69830094728082936495 -0.36139066128522479016 -0.41876801599614499327 -0.068292305176766446295 0.036508282360250082776 -0.10938609984643787865 -0.29671794837237369658 1.3140940479534615193 0.099096677859613735428;0.22533241926721681025 1.273043591134369823 0.40381098093534217863 1.2121700126677372733 0.106845109312652356 -0.44435484655300222512 -0.13423524630358396603 0.72866126494518745904 0.75629207140330412251 0.90000668715559128952;-0.34513463740344402231 1.3100877770466239358 -0.097255699894658639848 1.1220945547689569199 -0.43110188831892098937 0.35232208681206805823 0.30702427178522867512 0.45543949402967881523 -0.34453928815918188899 0.5820118537933109959;-0.020990403514666775703 -0.71867963045551219725 -0.18116412803786152708 -0.36110945325760607227 -0.58200259247836938492 0.33788299967045332117 0.4658937327234825565 -0.17371439723188708548 0.24642037416316356357 -0.0066762931132485483707;-0.38806414378992659664 0.56682433001028109665 0.57661687005565220865 -0.89385973199620460949 -0.088212649260974260179 -0.46587024058448683883 -0.144172264145346396 -0.020774045131084255961 1.2747659019188599672 0.070008921618311084623;0.042265678267168829696 0.3927587100172704182 0.12348691780728987544 0.43937862383957682066 0.49231872950902999531 -0.24544847637308539468 -0.41661940859204682486 0.15854686655325439526 -0.56754110282979186586 0.014513154940844161592];

% Layer 6
b6 = [-0.023962574591725852718;0.13103958368766996379;-0.24332631213457595054;-0.27005232208737378619;-0.0080853030969533536132;-0.15622311989295442625;-0.099806257446441379311;0.12583128661784923064;-0.072306812056692204571;0.3381985437435566233];
LW6_5 = [-0.04548638875874370241 0.051456704218445739607 -0.33818835622424309184 -0.038890497787501053517 -0.22688508701508319776 0.24845326787688007397 -0.12755664940735358948 0.17437014976969300584 0.25229142732089870904 -0.13879783338808598936;-0.22814823591747024345 -0.082365457856726345676 -1.0889137595743476616 -0.49725450785262365061 -0.068348138593559301657 1.1857236096405396886 0.10319299977559513726 -0.042848824475710756143 1.1666837877368314569 -0.19820705949843625548;0.48017304443039116046 0.53234628702185848859 0.085804591129253315884 -0.31072126845046482702 -0.78082371764760583055 0.49505453577317398706 0.9990484601711833168 -0.7588890995769749237 0.48471895282965271612 0.46832058215675831381;0.086976549081603973801 0.54975107867668560058 0.17489421091120549434 0.21796455479405074662 0.07632930634403387038 -0.3506949990955858798 -0.20601396479653269478 -0.42444973424475013202 -0.83232516953235402557 0.49028241474503730934;0.087662976597107603038 0.26167546648562584055 -1.4637289612200903299 -0.82792419974043918174 0.67973677005619548286 0.71167518770902926661 0.87429655427162300541 -0.23139929849066295797 -0.57926119357768723894 0.42923231438178660602;0.14678799057756072854 0.32156167550051095727 -0.138563030286100064 -0.090741310390769019945 -0.24635788975048611427 -0.074677865417156819028 0.034828090902490276004 -0.43642720381780131245 -0.088946713212833372619 0.39279400967673017142;0.36342884320896301498 -0.029069387661470227902 0.34469709871808340562 -0.1801643202098576757 0.20120503394359451343 -0.056248503836617502749 0.34441911763698873639 -0.13855608863334514802 0.10520850460810737825 0.043063300053962826064;-0.38197687256831841518 0.0083733322863200239372 -0.98414417731994752181 -0.0869067165985348139 -0.13550921893988998601 -0.94940491852478303691 0.38697784542222696258 -0.35136708007095240891 -0.032600238136846398929 0.3315186751869170223;0.14791526716446942724 0.058771804284521923789 0.28211008789560176879 0.13766757602464238519 0.16305212236967978057 -0.39988168918895244941 -0.10847949310356046204 -0.13685734253992232201 -0.4983958664010663675 0.14771786481516441247;-0.23512099425643570583 -0.23067085391826835927 -0.46010595340765841899 -0.39298498041567442307 -0.1995709285062598759 0.71687895782195443228 0.2279319172233760793 -0.0067669363337763575525 0.99475309798965738661 -0.095808534663088029681];

% Layer 7
b7 = [0.65992062865215173062;1.5926106278080605083];
LW7_6 = [0.17758165115191579253 0.73440614241348112223 -1.8002004461434946148 -0.50666386905802052176 -1.8815900641583802599 -0.077791607041002186484 -0.60505861793438109331 1.5402969715737853118 -0.12356483725726744027 0.44717513382576590253;-0.28437976754372251698 -1.238321026786673773 -0.025835273538597044313 0.051477520750621875989 -0.21083959169394989042 -0.2462218466416563889 0.11204129997673525909 0.69679799827893751374 0.30163038027218019854 -0.68718341549394890144];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [10.0250626566416;0.574712643678161];
y1_step1.xoffset = [0.0005;0.1];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = tansig_apply(repmat(b4,1,Q) + LW4_3*a3);
    
    % Layer 5
    a5 = tansig_apply(repmat(b5,1,Q) + LW5_4*a4);
    
    % Layer 6
    a6 = tansig_apply(repmat(b6,1,Q) + LW6_5*a5);
    
    % Layer 7
    a7 = repmat(b7,1,Q) + LW7_6*a6;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a7,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(7,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
