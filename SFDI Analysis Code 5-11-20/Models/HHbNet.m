function [Y,Xf,Af] = HHbNet(X,~,~)
%HHBNET neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 11-May-2020 01:45:10.
% 
% [Y] = HHbNet(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 25xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.0389084211656495;0.0909179397692164;0.148912326099436;0.178958411792067;0.164313635673712;0.0302408178321022;0.0501556044225224;0.0594455865734966;0.0615528144154508;0.0570773679499261;0.020252336723841;0.0253735318945678;0.027376833188251;0.0279179611958428;0.0265877287604747;0.0147655635366815;0.0174023385549338;0.0180309337834437;0.0182359324795718;0.0176672688471666;0.0117608482616474;0.0131078648569558;0.0137512894446312;0.0137484943403961;0.0135128742034263];
x1_step1.gain = [2.46876281369233;2.41849450771499;2.54602144219724;2.6830265177666;2.79929822303711;2.7873011921642;2.84101083599418;2.80861828600202;2.85926293571591;2.89217796326736;3.49248981119232;3.43088732562277;3.45208553515754;3.44628188427082;3.47782845606763;4.2072805026821;4.20776190726682;4.22453598170166;4.20053395897608;4.26863573612728;5.1350183761141;5.12322805397175;5.10980059283706;5.15268957414816;5.09103976409506];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3905303630034797635;1.7844854922749822101;0.0392499570481432275;-1.7338144155751922248;-0.71068757849765828993;1.1407148222294059003;1.3998420790518601997;-1.4891931318029925091;-0.60633133289632112906;1.8889636593983472057];
IW1_1 = [-0.74640025685747457551 0.44141137044476519424 0.1669230612933490232 -0.33289321999720883349 -0.052515090041237756646 -0.057160661947911334257 0.50438372448736090714 0.32323423998461070505 0.25501713978763984603 0.099517884976291604016 0.22405887273746905031 0.26892883352954966014 0.15397420450576532192 -0.31459487306344707802 0.44393804438708506233 0.47963406709980493936 -0.40587421769148152029 0.0074837079794793743767 0.046427393792819827978 0.40956162822565916892 0.25208598337437265746 -0.43410925519213278134 -0.18964668371559592619 0.0088961003687731757261 0.2437647656927986739;-0.049152366611420694742 -0.65680284411657596788 -0.5198864431929285379 -0.020131032167129424976 -0.035618375189684386983 0.63996185236109914829 0.59103460907799953983 0.81280784823288354524 0.49810043024441796877 -0.21919020179206344379 0.13897653048963273803 0.26934080185334852153 0.33668413436052224696 0.022797362335561531521 0.12380102084072751312 -0.12404648395184569853 0.16167772415689807275 -0.1062479963482873685 -0.11338584513563806921 0.016328361035769227427 -0.0099563475088153205461 -0.14494285639678664013 -0.073989337324198461987 -0.049807975885286986939 -0.22711505448401478335;-0.44640165751772509228 -0.74328480529069185234 -0.23265015914087791571 0.10280797952395231976 0.052746193856000281319 -0.20682050964320086717 -0.55754936742020533291 -0.13805117845239139873 -0.2057840056505187698 0.15500868621711541562 0.0053249616230844690201 0.13788690571620593195 0.24150738091065826474 -0.087630843489527543433 -0.085293859662655444054 -0.041518551256486894985 0.15707787223555386147 0.050684761605809085239 -0.14393687465890753208 -0.3381629580028684412 0.69358970979931444667 0.27770491112291378899 0.20880930899345889751 0.03277202150965796007 -0.032365592014807334498;0.31793882821852348375 0.26819983794328161597 -0.170704721750764149 0.16114419635171808864 -0.29459121092255119434 0.38301624511267329254 0.12498510290892546337 0.11686298136555448024 -0.073152463889392338459 -0.3954780375350241961 -0.18677777898713737725 -0.0708193644614442952 0.065618048698585965117 0.35977298965528098362 -0.10601047965058346678 -0.42843939129763580764 0.032169149625309471918 -0.017582790033373221772 0.086464579338864477887 0.64654727159966374206 -0.53760371084147262621 -0.56554831916200687392 0.088834851147055013398 0.071696022746483734078 0.59626360594099847567;0.26713364668953909487 0.69462440121773350032 0.25703501664729849763 0.55428803231508583238 -0.60220534868278596807 0.20282367111460100628 0.26399385307433831382 -0.054287886988456844628 -0.23525900182476733313 0.13608089039419654642 0.37779706691337361368 0.4356012721962507217 0.10275797678945551572 0.42666370702418232597 0.047216383307106112033 -0.13933925566954155628 0.14121684092647429631 -0.061855708825923734484 -0.38737979714544124032 0.29078087868944924033 0.34118297670088160167 -0.17041862698264068077 -0.23729914752477040962 0.079065213103594642052 -0.072600720514766528546;0.40416637158770013505 -0.067627488386036854751 0.052475364831405420241 0.32572483565365534242 -0.048482108305053742137 0.64186012815294002376 0.50226567123982512886 0.60504982615160651793 0.20614208682865253763 -0.02798443898265265059 0.091967933347136085476 0.12841215244378745286 0.21449895369840640824 -0.09117021699721679362 0.13360749743155561631 -0.20264793547734566426 -0.064290737587333016134 -0.21700498101429910314 -0.1993295506788466398 0.20493290755775381284 -0.3030481860171180819 -0.36968308742856864635 -0.29501776032631721325 -0.30102340966179458315 0.27289529463076211968;0.38929396026472806724 -0.82013751421119396312 -0.83384391943764224475 -0.30228718236242968498 1.9760626202152042907 0.15146164147891932883 -0.32622943644388063822 -0.79997905979292160961 -0.07125700220907939253 -0.010511633782068093707 0.66056628633579017595 -0.65061545794168784695 -0.20367559207723226478 -0.27229156286785721752 0.11427845405606405771 0.6941322016125298644 -0.31290852661437906779 -0.16327279815890119452 -0.15503009455402871897 0.010659340058094731937 0.098163010239058157147 0.31631937751720279328 0.43038052548803606978 0.096990661373447945026 -0.50441938545856923604;-0.55777656130303088222 -0.049881154601604721366 -0.64187176598031159269 -0.35724900077443677571 -0.66751116012528233234 0.05367868620796355239 0.27121512436044070693 0.35312330111585821246 0.66794842252829955687 0.2442770690086865093 -0.48006108431171123918 0.014423078743514113759 -0.11117549336269083593 0.25616691083067405499 0.25631522593571798296 -0.51025574311126575822 -0.21619159274631158385 -0.11238619991676572496 0.24411133686295724554 0.10431422407693793919 -0.067774468687566563618 -0.593878883361658505 -0.25810454924306919233 0.42058642146067010126 0.1597224742669412223;-0.81196339171828446624 0.051164005327653236388 0.18205703877345005837 0.15100126332300911614 0.096902135037258932404 -0.46007195430910580169 0.29654862418568467275 0.50688845329643794635 -0.024963734722307891895 0.78524042998023835249 -0.60297961595232507648 -0.035645533879264369725 -0.099085820260648993507 0.12711829148059708428 0.23080928977273204583 0.032688890939002679392 0.16491667854642566571 0.22917604722082027258 0.18482052739904933358 0.3129609412421671677 -0.21677466235872488998 -0.11089589090354522172 -0.1997332921654330351 -0.1239829088042953692 -0.14606734216322150854;-0.15739118296687618082 -0.72709942331947252647 -0.23734988797198394717 -0.01114898828620768112 0.08596732420860349333 0.035419997177810594313 -0.024506468697781502719 -0.064972579187782680821 -0.19591862553848318762 0.34274876015795735507 -0.21242280844164287967 -0.34928511153509633758 -0.23513837652683342028 0.34999857610280743492 0.58328269292727319417 -0.57439866394899730118 -0.21153443360866727718 0.37996300693345930188 0.32770215910015865202 -0.084768366033770539691 0.071005861035650860713 0.021419812202124501044 -0.48579509924633018647 -0.044230474588623683307 -0.54533977920604659317];

% Layer 2
b2 = [-1.245489237596752119;1.4613781143418984598;0.84829320603285474078;-0.23784882147179778333;-0.3029089356553874568;-0.43355551896796057365;-0.057831137074168093015;0.70256550502454295781;1.2558022803108361831;2.1362928605574631469];
LW2_1 = [0.78221490697251550017 0.54207219611750301347 -0.57271634312331443084 -0.1434984759507887675 0.16383888824660655659 0.035679094036041428262 -0.31115542548081154273 -0.24805072239782874344 0.19343711548752470786 -0.42915482843386426604;-0.85617128700862110691 -1.4215861989640192764 -0.40837656261473381791 -0.48745469464358248679 0.23046385935040583637 1.1501596813203582848 -0.30900489573990269632 0.6204825124038830797 -0.56710982295328360436 -0.81856679097843254578;-0.27085954095877923242 0.23531508302751769079 0.16423234381839324492 0.532950397437891632 -0.22670239486047091826 -0.19572066041542096615 -0.28828731874302526705 0.22770036233396342973 -0.017521284296460343938 0.3065246985432475979;-0.66211719716304195948 0.17953011405992205796 0.4913478060322797325 -1.1871410166383673523 0.36518147571741638169 -1.0845999577167415584 -0.11911269458138612487 -0.70163564790757393386 -0.39628571688311320376 1.0976818751407624308;1.3389006806371586134 -0.15308307438215235097 1.0359672333266232158 -0.32582464833912616609 0.6010757323834500232 -1.2300052174060733812 -0.10063331592096545763 -1.0917466815535727953 -0.28566809355613226318 0.51641480372881565231;0.37308828560021256582 0.79178403900972715856 -0.39741852058244181434 -0.075491795163474567643 0.10447933892885927221 -0.84316556678368415056 0.27784867749455421926 -0.57962175723326536669 -0.30940556728026352706 -0.73637096200265472756;0.22254106244117727309 1.674090720443158764 -0.34424287608637871294 -0.22820319303802055755 0.15381521518249677283 -1.0108625681070000368 -0.39434515241623629977 0.61055182852140144067 0.20834042184923626251 -0.24573276031094848371;-0.36690476876760308445 -0.84631730112549463652 0.2304096712972718286 -0.096884693615933700772 -1.0244347029945695127 -0.67755583796047569312 1.0381563782462270851 1.1843826287307861467 0.33043945289109893926 -0.37391942305165121185;0.4091827920794081086 -0.99237742823231056555 -0.60178691636908154816 -1.1446955935790390502 0.20501446019744509752 0.18929472894601120925 -0.98957873019527597958 -0.11142414277111530041 -0.21821840199449571429 -0.20682097565709864351;1.1997063271483658919 -0.32675648894045877801 -0.63070343018239261035 0.049145681947940125789 0.6812039783695809092 -0.66127203469625672749 -0.48472158937898723874 0.8367991108037637904 -0.076606024518923745981 0.21262213853715380973];

% Layer 3
b3 = [1.025606582564360103;-1.3258375600739551459;-0.8861784668740392279;-0.36802387401713099191;-0.17315509195434070078;-0.1063549528118403753;-0.57620883901391251047;-0.85230830971304660792;-1.0113537667670069453;1.5992805080690664088];
LW3_2 = [-0.92132832034994183168 0.008638410984442615112 -0.96602679002914382256 -0.20580039173348474435 0.090618164821881799775 0.19555211483529097438 0.061828991217446331585 -0.39286685263224324638 -1.1207220717758363815 -0.37509230873953852692;0.58199414561003504076 0.51789137938883744727 -0.81523256659025933324 0.50969115088061900387 -0.60956190655134434575 -0.019697006063111418411 0.072155480440728114733 -0.93851183887358191615 -0.43183992022898809449 0.44054263877863836241;0.81244507072805249859 -0.37981248539493661642 -0.11243601880127787607 0.0090612172504708678872 0.24959090491884214358 -0.13866971167926972486 0.57390188772336137024 0.49092474019378778971 -0.72415122960842326361 -0.50297613375571104122;0.69643726039354414414 -0.21509211818447460107 -0.49760500574413168984 -0.32051242221678055699 -0.42327220283662514433 -0.47307310312417055753 0.023308591957736254918 -0.68817042212834600434 -0.37900973270334831211 0.46245655537120866629;-0.58759083619079000016 -0.5954759441390314878 -0.84066924237507090201 -0.11950542778566941582 -0.77676328777666392433 -0.10173382601535291281 0.19634007867716554707 -0.60578295281923311144 0.7417913153704601692 0.0911788186714055926;-0.37668835214484075458 0.82651678900562020047 -0.027969825298006466968 0.75589665858076970917 0.31176429212443801386 -0.31849910664459907261 -0.34611508677564334358 0.50636876322453960864 0.60589245132022429008 0.29022502345005524171;-0.92240274695827095819 -0.66330626455145158538 -0.084719471631403239775 -0.37719401105463301604 0.76769980894807188232 -0.14069347676282190074 -0.70077147256294092248 0.95644176607798314649 -1.0475308785821320079 0.53346009159132412591;-1.1970903112530364432 -0.97667048573341785911 -0.27486771872039211795 -0.45598535542621987382 0.14705102400436409482 0.53561667611934371536 0.64752739059364383678 0.59705010035830474724 0.66231169645494947229 -0.62144400275558253632;-0.048435426170200829299 -0.77893778150905834678 0.67639820305677322843 -0.21234856689810990837 0.4952406566976771396 -0.0097681109202093028415 0.7520336889652619039 -0.26827616456693953451 -1.4203329149594958736 -0.094378783488737683083;0.39175543292890036007 -0.2592929473492607273 0.14516762823112941416 0.47908884620949976352 0.74325480749167993633 0.5903948564841481339 -0.38716335965113368722 0.49185619147240172699 0.83724707610757853615 0.24052786858473187981];

% Layer 4
b4 = 1.072411556250068676;
LW4_3 = [0.42396626825240113501 -0.18596304934006743781 0.46300469572761221437 0.24085529102983060934 -0.085644442763110673056 0.23580035046416683575 -0.081562670414521129536 0.61330473749982883369 1.7086396614799994609 0.43859686401369696318];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 20.0003257828625;
y1_step1.xoffset = 1.44511766053679e-07;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
